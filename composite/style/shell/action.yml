name: "suggester / shell"
description: "Uses reviewdog to suggest shell script format changes. Enforces ShellCheck."

inputs:
  changed_shell_files:
    description: “list of changed shell files.”
    required: true

runs:
  using: "composite"
  steps:
    - uses: actions/checkout@v3

    - id: shfmt_suggester
      run: |
        echo ${{ inputs.changed_shell_files }}
        shfmt -l -w ${{ inputs.changed_shell_files }}
      shell: bash
      continue-on-error: true

    - name: suggester / shfmt
      uses: reviewdog/action-suggester@v1
      with:
        level: 'warning'
        tool_name: shfmt
      continue-on-error: true

    - name: "ShellCheck"
      uses: reviewdog/action-shellcheck@v1
      with:
        reporter: 'github-pr-review'
        exclude: |
          ./vendor/*
          */vendor/*
        shellcheck_flags: |
          --external-sources -e=SC1091
